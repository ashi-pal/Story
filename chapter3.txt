Chapter3 with modification